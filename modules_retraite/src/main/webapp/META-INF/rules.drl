package org.jahia.modules.ci.templates.rules

#list any import classes here.
import org.jahia.services.content.rules.*
import org.jahia.services.content.JCRContentUtils
import org.slf4j.Logger

expander rules.dsl

#declare any global variables here
global User user
global Service service
global Logger logger
global JCRContentUtils jcrUtils

rule "Flush URL resolver cache"
    when
    	A property pageTitle has been set on a node
			- the node has the type jnt:ciQuestion
    then
    	Get the ancestor "page" of type jnt:page
        Execute the action "questionFlushCacheNodeBackgroundAction" now on the node
        Log "flush cache on " + page.getPath()
end